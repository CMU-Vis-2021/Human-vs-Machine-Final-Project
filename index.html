<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon_io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon_io//favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon_io//favicon-16x16.png">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
          Insightful Saliency Maps</title>
        <link rel="stylesheet" href="./style.css" />
        <script src="https://d3js.org/d3.v6.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js"></script>
        <script type="text/javascript" src="imgstruct.json"></script>
    </head>
    <body>
        <div class="container" id="top">
            <h1>In<span style="font-style:  italic;">sight</span>ful Saliency Maps</h1>
            <nav>
              <button id = "openTab1" onclick = "changeTab(this,'tab1')" class = "active">Stylize an Image</button>
              <button id = "openTab2" onclick = "changeTab(this,'tab2')">Saliency Similarity</button>
              <!-- <button id = "openTab4" onclick = "changeTab(this,'tab4')">Model Comparison</button> -->
              <button id = "openTab3" onclick = "changeTab(this,'tab3')">Explain an Image</button>
            </nav>
            <div id = "tab1">
                <h2>Make your own stylized image. See what the AI predicts. Is it biased towards texture or shape?</h2>
                <div class = "flex">
                    <div class = "flex-inner step">
                        <label for="shape"><span class = "number">1</span>Choose a shape:</label>
                        <br>
                        <div class = "select">
                            <select class = "standard-select" name="shape" id="shapeselect0" onchange="shapeImg()">
                                 <option value="-1" selected disabled hidden>Select choice</option>
                                 <!-- <option value="cat">Cat</option> -->
                                 <option value="dog">Dog</option>
                                 <!-- <option value="elephant">Elephant</option> -->
                                 <option value="bear">Bear</option>
                             </select>
                         </div>
                         <img id="shapeimg0">
                     </div>
     
                     <div class = "flex-inner step">
                         <label for="texture"><span class = "number">2</span>Choose a texture:</label>
                         <br>
                         <div class = "select">
                             <select class = "standard-select" name="texture" id="textureselect0" onchange="textureImg()">
                                 <option value="-1" selected disabled hidden>Select choice</option>
                                 <option value="bikes">Bicycle</option>
                                 <option value="tiger">Tiger</option>
                                 <option value="trucks">Trucks</option>
                                 <option value="zebra">Zebra</option>
                                 <option value="elephant">Elephant</option>
                             </select>
                         </div>
                         <img id="textureimg0">
                     </div>
     
                     <div class = "flex-inner step">
                         <label for="shape"><span class = "number">3</span>Stylize the Image:</label>
                         <br>
                         <button class = "blue" onclick="stylizeImg()">Stylize</button>
                     </div>
                     <div class = "flex-inner step">
                         <label for="shape">Stylized Image</label>
                         <div class = "output-labels">
                             <p>AI Prediction: <span id = "prediction" class = "output"></span></p>
                             <!-- <p>Biased: <span id = "biased" class = "output">Texture</span></p> -->
                         </div>
                         <img id="stylizedimg0">
                     </div>
                </div>
                <div class = "more-images">
                    <p>Want to stylize another image?</p>
                    <img alt = "plus icon" src = "assets/icons/plus.svg" id = "plusicon" onmouseenter="hoverImg()" onmouseleave="leaveImg()" onclick="styleAnother()">
                </div>
                <button id = "detailsButton" class = "blue" onmouseenter="hoverBtn()" onmouseleave="leaveBtn()" onclick="location.href='#details'; includeHTML();">Learn about Style Transfers and Saliency Maps</button>
                <div id="details">
                    <button id = "topButton" class = "blue" onmouseenter="hoverBtn()" onmouseleave="leaveBtn()" onclick="location.href='#top';">Go to top</button>
                    <h1>About  In<span style="font-style:  italic;">sight</span>ful Saliency Maps</h1>
                    <div w3-include-html="./content.html"></div>
                </div>
            </div>
            <div id = "tab2" class = "hidden">
                <h2>Explore the saliency maps of stylized images. See how they compare to the saliency map of the original, un-stylized image.</h2> 

                <div class="flex">
                    <div class = "flex-inner step" id = "stylized-saliency"> 
                      
                        <p style="text-align: center;"> <b> Choose a stylized image:</b></p>
                      
                        <div class="stylized-select" style="padding: 10px; text-align: center;">
                            <select class = "standard-select" name="stylized" id="stylized-ss" onchange="ssimg()" style="width:30%;">
                               <option value="-1" selected disabled hidden>Select choice</option>
                               <option value="dog-stylized-tiger">Dog x Tiger</option>
                               <option value="dog-stylized-zebra">Dog x Zebra</option>
                               <option value="dog-stylized-trucks">Dog x Trucks</option>
                               <option value="dog-stylized-bikes">Dog x Bikes</option>
                               <option value="dog-stylized-elephant">Dog x Elephant</option>
                               <option value="bear-stylized-trucks">Bear x Trucks</option>
                               <option value="bear-stylized-tiger">Bear x Tiger</option>
                               <option value="bear-stylized-zebra">Bear x Zebra</option>
                               <option value="bear-stylized-bikes">Bear x Bikes</option>
                               <option value="bear-stylized-elephant">Bear x Elephant</option>
                           </select>
                        </div>
                        <div class="flex" id="stylized-img-div">
                            <img id="stylized-img-ss">
                        </div>
                        <div id="sliders" style="display: none;">
                            <input type="range" id="sliderOpacity" min="0" max="100" value="40" class="sliders" oninput="changeOpacity()" /> <span id="numOpacity">40</span>%
                        </div>
                        <div style="text-align: center;">
                            <input type="radio" name="xraiList" value="show" id="xrai" onchange="xrairadio()" checked>Show XRAI
                            <input type="radio" name="xraiList" value="hide" id="xrai" onchange="xrairadio()">Hide XRAI
                            <input type="radio" name="xraiList" value="overlap" id="overlap" onchange="xraioverlap()">Overlap XRAI
                        </div>
                    </div>
                    <div class = "flex-inner step" id = "original-saliency">
                        <p> <b> Original image: </b> </p>

                        <div class="original-select" style="padding: 10px;">
                            <select class = "standard-select" name="original" id="original-ss" onchange="ogimg()" style="width:30%;">
                               <option value="-1" selected disabled hidden>Select stylized image</option>
                               <option value="dog" disabled>Dog</option>
                               <!-- <option value="elephant" disabled>Elephant</option> -->
                               <option value="bear" disabled>Bear</option>
                           </select>
                        </div>
                        <div class="flex" id="original-img-div">
                            <img id="original-img-ss">
                        </div>
                        <div id="slidersOg" style="display: none;">
                            <input type="range" id="sliderOpacityOg" min="0" max="100" value="40" class="sliders" oninput='changeOpacity(slider = document.querySelector("#sliderOpacityOg"), imggchoice = document.querySelector("#xrai-og-img"), text = document.getElementById("numOpacityOg"))' /> <span id="numOpacityOg">40</span>%
                        </div>
                        <input type="radio" name="ogList" value="show" id="og" onchange='xrairadio(document.getElementsByName("ogList"), query = ".flex #original-img-div", appendHTML = "<img id=\"original-img-xrai\">", originalHTML = "<img id=\"original-img-ss\">", sliders= document.getElementById("slidersOg"),opacityNum = document.querySelector("#sliderOpacityOg"))' checked>Show XRAI
                        <input type="radio" name="ogList" value="hide" id="og" onchange='xrairadio(document.getElementsByName("ogList"), query = ".flex #original-img-div", appendHTML = "<img id=\"original-img-xrai\">", originalHTML = "<img id=\"original-img-ss\">", sliders= document.getElementById("slidersOg"), opacityNum = document.querySelector("#sliderOpacityOg"))'>Hide XRAI
                        <input type="radio" name="ogList" value="hide" id="og" onchange='xraioverlap(document.getElementById("original-ss"), id="original-img-ss", query = ".flex #original-img-div", appendHTML = "<img id=\"original-img-ss\" style=\"position: relative;\"> <img id=\"xrai-og-img\" style=\"position: absolute; opacity: 40%\">", sliders = document.getElementById("slidersOg"))'>Overlap XRAI
                    </div>
                </div>
                <div class="visualize-similarity">
                    <div id="salsim-div" style="display: none;">
                        <p> <b> Visualize the similarity between the two saliency maps. </b> </p>
                        <div class="flex">
                            <div class="flex-inner step" style="padding: 20px;">
                                <div style="text-align: center;">
                                    <p>Intersection:</p>
                                </div>
                                <div id="sliders">
                                    <input type="range" id="sliderAlpha" min="0" max="20" step="5" value="15" class="sliders" oninput="changeAlpha()" /> <span id="numAlpha">15</span> delta
                                </div>
                                <img id="salsim-img" style="border: 0px; width: auto;"/>
                            </div>
                            <div class="flex-inner step" style="padding: 20px;">
                                <p>Comparison of Top-K Colors:</p>
                                <div id="sliders">
                                    <input type="range" id="sliderK" min="2" max="7" step="1" value="6" class="sliders" oninput="changeK()" /> <span id="numK">6</span> colors
                                </div>
                                <div class="flex">
                                    <div class="flex-inner step">
                                        <div id="salsim-pie1" style="padding: 5px;"> </div>
                                    </div>
                                    <div class="flex-inner step">
                                        <div id="salsim-pie2" style="padding: 5px;"> </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="visualize-similarity" >
                    <p> <b> Compute the average saliency map</b> </p>
                    <div class="flex">
                        <div class="flex-inner step">
                            <p id="average-title"> <b> Choose an Image Class: </b> </p>
                            <div class="average-select" style="padding: 10px;">
                                   <select class = "standard-select" name="average-select" id="average-select" onchange="displayImgs()" style="width:70%;">
                                       <option value="-1" selected disabled hidden>Select choice</option>
                                       <option value="dog">Dog</option>
                                       <!-- <option value="elephant">Elephant</option> -->
                                       <option value="bear">Bear</option>
                                   </select>
                            </div>
                            <p id="imageOptions" style=" display: none; font-size: 12px; color: gray; font-style: italic;"> Select the images below to include in the average: </p>
                            <div class="row" id="imageOptions rows" style="display: none;">
                                <div class="column">
                                    <div class="card" id="img 1" name="none">
                                        <img id="imggrid 1" style="margin: 0px" onmouseenter="hoverImggrid(document.getElementById('imggrid 1'))" onmouseleave="leaveImggrid(document.getElementById('imggrid 1'))" onclick="addImg(document.getElementById('img 1'))" src="./assets/shapes/bear.jpg" >
                                        <img style="display:  none;" id="imggrid 1 heatmap" src="./assets/shapes/bear.jpg">
                                    </div>
                                </div>

                                <div class="column">
                                    <div class="card" id="img 2" name="name">
                                        <img id="imggrid 2" style="margin: 0px" onmouseenter="hoverImggrid(document.getElementById('imggrid 2'))" onmouseleave="leaveImggrid(document.getElementById('imggrid 2'))" onclick="addImg(document.getElementById('img 2'))" src="./assets/shapes/bear.jpg">
                                        <img style="display:  none;" id="imggrid 2 heatmap" src="./assets/shapes/bear.jpg">
                                    </div>
                                </div>
                              
                                <div class="column">
                                    <div class="card" name="none" id="img 3">
                                        <img  id="imggrid 3" style="margin: 0px" onmouseenter="hoverImggrid(document.getElementById('imggrid 3'))" onmouseleave="leaveImggrid(document.getElementById('imggrid 3'))" onclick="addImg(document.getElementById('img 3'))" src="./assets/shapes/bear.jpg">

                                        <img style="display:  none;" id="imggrid 3 heatmap" src="./assets/shapes/bear.jpg">
                                    </div>
                                </div>

                                <div class="column">
                                    <div class="card" name="none" id="img 4">
                                        <img  id="imggrid 4" style="margin: 0px" onmouseenter="hoverImggrid(document.getElementById('imggrid 4'))" onmouseleave="leaveImggrid(document.getElementById('imggrid 4'))" onclick="addImg(document.getElementById('img 4'))" src="./assets/shapes/bear.jpg">
                                        <img style="display:  none;" id="imggrid 4 heatmap" src="./assets/shapes/bear.jpg">
                                    </div>
                                </div>
                              
                                <div class="column">
                                    <div class="card" name="none" id="img 5">
                                        <img id="imggrid 5" style="margin: 0px" onmouseenter="hoverImggrid(document.getElementById('imggrid 5'))" onmouseleave="leaveImggrid(document.getElementById('imggrid 5'))" onclick="addImg(document.getElementById('img 5'))" src="./assets/shapes/bear.jpg">
                                        <img style="display:  none;" id="imggrid 5 heatmap" src="./assets/shapes/bear.jpg">
                                    </div>
                                </div>
                            </div>

                            <button id = "averageCompute imageOptions" style="display:  none;" class = "blue" onmouseenter="hoverBtn()" onmouseleave="leaveBtn()" onclick="computeAvg();">Generate Average Saliency Map</button>
                        </div>

                        <div class="flex-inner step" id="canvasAvg" style="display: none;">
                            
                            <p id="imageOptions" style="font-size: 18px; font-weight: bold;"> Average Saliency Map: </p>
                            <img id="avgHeatmap">
                        </div>
                        <div class="flex-inner steos" id="ogHeatmap" style="display: none;">
                            <p id="imageOptions" style="font-size: 18px; font-weight: bold; margin-top: 0px;"> Original Saliency Map: </p>
                            <img id="ogheat" style="margin-top: 12px;" src="./assets/shapes/bear.jpg">
                        </div>
                    </div>

                </div>
            </div>
            <div id = "tab3" class = "hidden">
                <div class = "flex">
                    <div  class = "flex-inner step"><h2>Draw what the AI sees.<br>See how your perception compares to the AI.</h2></div>
                    <div class = "flex-inner gifTopper">
                        <img id = "canvasImg">
                    </div>
                </div>
                    <p>The AI makes predictions based on regions it feels are important to identifying the image. Can you guess what places in this image the AI feels are the <b><span class = "box yellow"></span>most important</b> to identifying it?<br>What is <b><span class = "box orange"></span>important</b> and <b><span class = "box red"></span>somewhat important</b>? Finally, what is <b><span class = "box purple"></span>least important</b>?</p>
                    <div class = "step">
                        <h3> Draw on the image how you think a computer would classify it</h3>
                        <div class = "flex">
                            <div>
                                <canvas id="canvas" width="330" height="330" >
                                Your browser does not support the HTML5 canvas tag.
                                </canvas>
                                <div class = "drawControls">
                                    <h4>Select a color</h4>
                                    <button class ="color-btn yellow active" onclick = "changeColorCanvas('yellow')">Yellow</button>
                                    <button class ="color-btn orange" onclick = "changeColorCanvas('orange')">Orange</button>
                                    <button class ="color-btn red" onclick = "changeColorCanvas('red')">Red</button>
                                    <button class ="color-btn purple" onclick = "changeColorCanvas('purple')">Purple</button>
                                </div>
                            </div>
                            <div id = "d3-canvas-bar">
                                <h4>Percentage of pixels correct so far</h4>
                                <p><span class = "ai"></span>= Here's a hint! This is how the computer sees</p>
                            </div>
                        </div>
                        <div id = "answerCanvas">
                            <h3>Here what the computer sees</h3>
                            <canvas id="canvas-compare" width="330" height="330" >
                            Your browser does not support the HTML5 canvas tag.
                            </canvas>
                        </div>
                        <img id = "canvasImg-compare" src = "./assets/quiz/doberman-heat.png" style="display: none;">
                        <button id = "revealAnswerButton" class = "blue" onclick="revealAnswer(this)">I'm done! Show me how an AI sees this image</button>
                    </div>     
            </div> 
            <!-- <div id = "tab4" class = "hidden">
                Compare models Tabs
            </div> -->
        </div>
    </body>
    <script type="text/javascript" src="./js/main.js"></script>
    <script type="text/javascript" src="./js/draw.js"></script>
    <script type="module" src="./js/canvasBar.js"></script>
    <script type="text/javascript" src="./js/includeHTML.js"></script>
    <script type="text/javascript" src="./js/piechartjson.js"></script>
    <script type="text/javascript" src="./js/imageSetup.js"></script>
    <script type="text/javascript" src="./js/predictions.js"></script>
    <script src="./opencv.js" type="text/javascript"></script>
</html>
